!function(e,t){"undefined"!=typeof module&&module.exports?module.exports=t(require("elliptical-utils")):"function"==typeof define&&define.amd?define(["elliptical-utils"],t):(e.elliptical=e.elliptical||{},e.elliptical.Controller=t(e.elliptical.utils),e.returnExports=e.elliptical.Controller)}(this,function(e){function t(e,t,o,i,p){for(var u in t)u!==n&&u!==l&&u!==a&&u!==c&&t.hasOwnProperty(u)&&r(u,e,t,o,i,p)}function r(e,t,r,i,n,l){var a,c=u.clone(t);if("Index"!==e||o(c[0])){var p=e.replace(/_/g,"-");c[0]=c[0].replace(/@action/g,p)}else c[0]=c[0].replace(/@action/g,"");a=c[0].length,"home"!==l.toLowerCase()&&(c[0]=a>1?"/"+l+c[0]:"/"+l),r[e].__name=l,r[e].__action=e,c.push(r[e]),n[i.toLowerCase()].apply(n,c)}function o(e){var t=e.split("@action");return t[1]&&t[1].length>1}var i,n="Get",l="Post",a="Put",c="Delete",p="get",u=e.array;return i=function(e,r){return this.app=e,this.name=r,function(o,i){var u=[].slice.call(arguments),f=u[0];if("string"!=typeof f)throw"Controller requires a route string with an '@action' placeholder  as the first parameter";var s=u.pop();if("object"!=typeof s)throw"Controller requires the last function parameter to be an object";t(u,s,p,e,r),[n,l,a,c].forEach(function(o){if(s[o]&&"function"==typeof s[o])throw"Controller requires an @action param";t(u,s[o],o,e,r)})}}});