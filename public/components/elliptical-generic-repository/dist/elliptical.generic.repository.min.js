!function(t,e){"undefined"!=typeof module&&module.exports?module.exports=e(require("elliptical-utils"),require("elliptical-lodash").c):"function"==typeof define&&define.amd?define(["elliptical-utils","elliptical-lodash"],e):(t.elliptical=t.elliptical||{},t.elliptical.GenericRepository=e(t.elliptical,t._.c),t.returnExports=t.elliptical.GenericRepository)}(this,function(t,e){function i(t,e,i){var r=(t-1)*e,n=t*e-1;return n>i&&(n=i),{start:r,end:n}}function r(t,i){return e.filter(t,function(t,e){return e>=i.start&&e<=i.end})}function n(t,i){return e.find(t,function(t){return t.id.toString().toLowerCase()===i.toString().toLowerCase()})}function o(t,i){return e.findIndex(t,function(t){return t.id.toString().toLowerCase()===i.toString().toLowerCase()})}function l(t,i){return e.sortByOrder(t,i,["asc"])}function u(t,i){return e.sortByOrder(t,i,["desc"])}function c(t,e){var i=o(t,e);return t.splice(i,1),t}function a(t,e){for(var i=0;i<e.length;i++){var r=e[i];c(t,r)}}function s(t,e,i){var r=n(t,e);for(var o in r)r.hasOwnProperty(o)&&void 0!==i[o]&&(r[o]=i[o])}function d(e,o){var d=arguments.length;if(0===d)throw"Generic Repository requires an array model passed in the constructor";"function"!=typeof o&&(o=null),this.model=e,this.callback=o,this.get=function(t,e,i,r){e&&"object"==typeof e?(r=i,i=e):e&&"function"==typeof e&&(r=e,e=null);var o,l=this.model;return o=t&&t.id?n(l,t.id):i&&i.filter&&void 0!==i.filter?this.query(i.filter):l,i&&i.orderBy&&void 0!==i.orderBy&&(o=this.orderBy(o,i.orderBy)),i&&i.orderByDesc&&void 0!==i.orderByDesc&&(o=this.orderByDesc(o,i.orderByDesc)),i&&i.paginate&&(o=this.paginate(o,i.paginate)),this.callback?void this.callback(o,"get",t,r):r?r(null,o):o},this.post=function(e,i,r){var n=e;"string"!=typeof i&&(r=i);var o=this.model;return e.id=t.guid(),o.push(e),this.callback?void this.callback(e,"post",n,r):r?r(null,e):e},this.put=function(t,e,i){"string"!=typeof e&&(i=e);var r=this.model;return s(r,t.id,t),this.callback?void this.callback(t,"put",t,i):i?i(null,t):t},this["delete"]=function(t,i,r){return"string"!=typeof i&&(r=i),t.id?c(e,t.id):t.ids&&a(e,t.ids),this.callback?void this.callback(null,"delete",t,r):r?r(null,null):null},this.Enumerable=function(){return Enumerable.From(this.model)},this.query=function(t,e){return this.model},this.orderBy=function(t,e){var i=[];return i.push(e),l(t,i)},this.orderByDesc=function(t,e){var i=[];return i.push(e),u(t,i)},this.paginate=function(t,e){var n=t.length,o=e.pageSize,l=e.page;l||(l=1);var u=i(l,o,n),c=r(t,u);return{data:c,count:n}}}return void 0!==e.c&&(e=e.c),d});